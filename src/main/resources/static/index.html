<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>UNO Oda Sistemi</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.5.0/sockjs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>
    <style>
        /* Modernize edilmiş CSS */
        body { font-family: 'Segoe UI', sans-serif; background: #eceff1; text-align: center; }
        #login-screen { margin-top: 100px; padding: 40px; background: white; display: inline-block; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .card { border: 2px solid #fff; padding: 15px; display: inline-block; margin: 5px; border-radius: 12px; width: 60px; height: 90px; color: white; font-weight: bold; cursor: pointer; box-shadow: 0 4px 8px rgba(0,0,0,0.2); }
        .RED { background-color: #ff5555; } .BLUE { background-color: #5555ff; } .GREEN { background-color: #55aa55; } .YELLOW { background-color: #ffaa00; } .WILD { background-color: #222; }
        input { padding: 12px; margin: 10px; border: 1px solid #ccc; border-radius: 8px; width: 200px; }
        button { padding: 12px 25px; background: #37474f; color: white; border: none; border-radius: 8px; cursor: pointer; }
    </style>
</head>
<body>

<div id="login-screen">
    <h1>UNO Online</h1>
    <input type="text" id="nameInput" placeholder="Adınız">
    <input type="text" id="roomInput" placeholder="Oda No (Örn: 1001)">
    <br>
    <button onclick="initGame()">Oyuna Katıl</button>
</div>

<div id="game-area" style="display:none;">
    <h2 id="roomStatus"></h2>
    <h3 id="turnInfo"></h3>
    <div id="top-card-area">
        <p>Yerdeki Kart</p>
        <div id="top-card"></div>
    </div>
    <div id="my-hand"></div>
</div>

<script>
    let stompClient = null;
    let playerId = "P" + Math.floor(Math.random() * 1000);
    let currentRoom = null;

    function initGame() {
        const name = document.getElementById('nameInput').value;
        currentRoom = document.getElementById('roomInput').value;
        if (!name || !currentRoom) return alert("Lütfen isim ve oda no girin!");

        const socket = new SockJS('/uno-game');
        stompClient = Stomp.over(socket);
        stompClient.connect({}, function() {
            document.getElementById('login-screen').style.display = 'none';
            document.getElementById('game-area').style.display = 'block';

            stompClient.subscribe('/topic/game-state/' + currentRoom + '/' + playerId, function(res) {
                renderGame(JSON.parse(res.body));
            });

            stompClient.send("/app/game.join", {}, JSON.stringify({
                roomId: currentRoom,
                playerId: playerId,
                playerName: name
            }));
        });
    }

    function renderGame(state) {
        if (!state) return;
        document.getElementById('roomStatus').innerText = state.statusMessage;
        document.getElementById('turnInfo').innerText = "Sıra: " + state.currentPlayerId;
        if (state.topCard) {
            document.getElementById('top-card').innerHTML = `<div class="card ${state.topCard.color}">${state.topCard.value}</div>`;
        }
        const handDiv = document.getElementById('my-hand');
        handDiv.innerHTML = '<h3>Senin Elin</h3>';
        state.playerHand.forEach(card => {
            const cardEl = document.createElement('div');
            cardEl.className = `card ${card.color}`;
            cardEl.innerText = card.value;
            handDiv.appendChild(cardEl);
        });
    }
</script>
</body>
</html>